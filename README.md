# Battle.net Account Switcher

A lightweight GUI tool to quickly switch between Battle.net accounts on Windows.

## Features

- **Automatic Dark Mode Detection**: Automatically loads your Windows theme preference (light/dark) on startup
- **Account Reordering**: When you switch to an account, it moves to the top of the list for quick access next time
- **Silent Operation**: No console window, runs cleanly in the background
- **Double-Click Support**: Switch accounts by double-clicking or using the button
- **Account List**: Displays all saved Battle.net accounts from your config file
- **Auto-Launch**: Automatically stops the current Battle.net process and launches it with the selected account
- **Config Backup**: Creates automatic backups of your Battle.net config before switching accounts

## How to Use

### Run the PowerShell Script Directly
```powershell
.\bnet-switcher-gui.ps1
```

### Build a Standalone EXE
```powershell
.\build.ps1
```

Then run the generated `bnet-switcher.exe`

### Build with Custom Options
```powershell
# With custom icon
.\build.ps1 -IconPath "path\to\your\icon.ico"

# With custom output filename
.\build.ps1 -OutputExe "MyAccountSwitcher.exe"

# Both
.\build.ps1 -SourceScript "bnet-switcher-gui.ps1" -OutputExe "AccountSwitcher.exe" -IconPath "icon.ico"
```

## Build System

The `build.ps1` script automatically:
- Detects or installs the `ps2exe` PowerShell module
- Compiles to 64-bit architecture
- Disables console window appearance
- Supports optional custom icons
- Verifies the output and reports file size

**Result:**
- **Output:** `bnet-switcher.exe` (~3-5 MB including .NET Framework)
- **Platform:** Windows x64
- **Execution:** No console window, silent operation

## Requirements

- Windows 10 or later
- Battle.net installed and launched at least once
- PowerShell 5.0+ (for PS1 version)
- .NET Framework (included on all Windows 10+)

## How It Works

1. Reads your Battle.net account list from `%APPDATA%\Battle.net\Battle.net.config`
2. Displays all saved accounts in a GUI listbox
3. When you select an account and click "Switch Account" (or double-click):
   - Your config file is backed up (`.backup`)
   - The selected account is moved to the top of the saved accounts list
   - The updated config is saved
   - The running Battle.net process is stopped (if any)
   - Battle.net is relaunched with the selected account
   - The GUI closes

## File Structure

- `bnet-switcher-gui.ps1` - Main GUI application (PowerShell)
- `bnet-switcher-console.bat` - Console launcher batch file
- `bnet-switcher.exe` - Compiled standalone executable (generated by build.ps1)
- `build.ps1` - Build script to compile PS1 to EXE using ps2exe
- `README.md` - This file

## Troubleshooting

### "Battle.net.config not found!" Error
- Ensure Battle.net is installed: `C:\Program Files (x86)\Battle.net\`
- Ensure Battle.net has been launched at least once
- Config file location: `%APPDATA%\Battle.net\Battle.net.config`

### Build script fails to install ps2exe
- Manually install with: `Install-Module ps2exe -Scope CurrentUser`
- Or download from: https://github.com/MScholtes/PS2EXE/releases

### GUI doesn't detect dark mode
- Requires Windows 10 build 1809 or later
- Check: Settings > Personalization > Colors > Choose your mode
- Falls back to light mode if detection fails

### Battle.net doesn't launch with the new account
- Ensure Battle.net is installed at the default location: `C:\Program Files (x86)\Battle.net\Battle.net Launcher.exe`
- Try running the GUI as Administrator
- Check that you have permission to modify the config file

## Author

Created by Blackwut | Enhanced with dark mode, automatic theme detection, silent operation, and build tooling

## Legal & Privacy

### ‚úÖ 100% Legal
This tool is a utility for managing your own Battle.net accounts. It only:
- Reads and modifies **your local** Battle.net configuration file
- Manages processes on your local machine
- Does not interact with Blizzard's servers in any unauthorized way
- Only performs the same actions you would manually do by logging in/out

### üîí Privacy & Security
- **No internet connection required** - This tool operates entirely offline
- **No data collection** - Your account information never leaves your computer
- **No telemetry** - No usage tracking, analytics, or external communications
- **Local operation only** - All operations happen on your machine
- **Open source** - You can inspect the PowerShell code to verify what it does
- **Config backups** - Automatic backups created before any changes for safety

### ‚öñÔ∏è Disclaimer
This is a community tool. Use at your own risk. Always keep backups of important files. The author is not responsible for any account access issues or data loss.

## License

Use as you wish.
